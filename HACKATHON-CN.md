## AgentKit：基于 Rust 构建通用 AI 自动化人机交互的技术构想 (MVP 探索)

**项目愿景：** 打造一个基于 Rust 的通用 AI 自动化套件 AgentKit，使 AI 能够像人一样理解和操作各种应用程序界面，最终实现跨平台、跨设备的智能自动化，提升人机交互的效率与便捷性。

**本次 Hackathon MVP 目标与当前状态：**

本次 Hackathon 的目标是初步探索和验证 AgentKit 的核心概念——通过 AI（简化的）驱动，实现对桌面 GUI 应用的自动化控制。我们选择 `gpui` 作为目标 UI 框架进行尝试。

**目前，我们已经搭建了项目的基本框架，并对核心流程进行了代码实现。然而，由于对 `gpui` 框架的 API（特别是其视图系统、上下文管理和事件处理机制）尚在熟悉过程中，`target_gpui_app` 部分的代码还存在一些编译错误未能完全解决，因此暂时无法进行完整的端到端演示。**

尽管如此，本次探索清晰地勾勒出了 AgentKit 的技术路径和潜力。

**MVP 核心组件与设想流程：**

1.  **`target_gpui_app` (目标应用 - 基于 GPUI):**

    - **设想：** 一个简单的 macOS 桌面应用，使用 `gpui` 构建。界面包含一个按钮，点击或接收外部指令后，背景颜色循环改变。
    - **交互接口 (ACP - 应用控制协议简化版):** 应用内嵌 TCP 服务器，监听来自 `agentkit_layer` 的 JSON 命令。

2.  **`agentkit_layer` (AgentKit 核心控制层 - Rust):**
    - **语音输入处理:**
      - 使用 `cpal` 捕获麦克风音频。
      - 利用 `whisper-rs` 和本地 Whisper GGML 模型进行**本地、免费的语音转文本 (STT)**。
    - **意图理解与命令生成 (LLM 驱动):**
      - 转录文本发送给兼容 OpenAI API 的 LLM (如 GPT 模型或本地 Ollama)。
      - LLM 将自然语言指令（如“改变背景颜色”）解析为预定义的 ACP 命令（例如 `{"action":"custom_command", "command_name":"CYCLE_COLOR"}`）。
    - **应用控制协议 (ACP) 通信:**
      - 将 LLM 生成的命令封装成 JSON 消息，通过 TCP 发送给 `target_gpui_app`。

**设想的演示流程：**

用户通过语音发出指令 -> `agentkit_layer` 进行 STT 和 LLM 意图理解 -> 生成 ACP 命令 -> ACP 命令通过 TCP 发送给 `target_gpui_app` -> `target_gpui_app` 执行命令并改变背景颜色。

**技术构想与价值：**

- **Rust 的潜力：** 验证了使用 Rust 构建此类自动化代理的可行性，利用其性能和安全优势。
- **模块化设计：** STT、LLM、应用控制各模块相对独立，易于替换和升级。
- **本地优先与隐私：** 本地 STT 的采用体现了对用户隐私和离线能力的考量。
- **LLM 赋能交互：** 展示了 LLM 在自然语言理解和任务分解方面的强大能力，是未来智能交互的关键。
- **应用控制协议 (ACP)：** 初步设计了应用间的控制协议，这是实现跨应用、跨框架自动化的重要基础。**我们认为，一个标准化的 ACP，结合强大的 UI 理解能力，是 AgentKit 通用性的核心。**

**对 GPUI 的期望与未来展望：**

在本次探索中，我们深刻体会到直接操作 UI 元素的复杂性。为了让 AgentKit（以及其他类似自动化工具）能够更深入、更可靠地与 `gpui` 应用交互，我们**非常期待 `gpui` 框架未来能够原生集成或提供对类似 AccessKit 的无障碍服务的支持。**

- **AccessKit 的价值：** AccessKit 能够提供一个标准化的、跨平台的接口，让外部工具（如 AgentKit）可以结构化地“理解”UI 元素的层级、角色、状态和可用操作，并能“执行”这些操作。这将远比依赖屏幕坐标点击或图像识别等脆弱方法更为可靠和强大。
- **AgentKit 的未来：** 若 `gpui` 及更多 UI 框架支持 AccessKit，AgentKit 的 ACP 协议可以演进为直接利用 AccessKit 的能力，实现对任意集成了 AccessKit 的应用进行精细化、语义化的自动化控制，真正实现“AI 像人一样操作电脑”的愿景。

**总结：** 虽然本次 MVP 由于时间限制和对 `gpui` API 的熟悉度问题未能完成可运行演示，但我们成功地勾勒了 AgentKit 的技术蓝图，并验证了其核心组件（本地 STT、LLM 意图理解、应用间控制协议）的设计思路。我们坚信，随着 `gpui` 等现代 UI 框架对无障碍技术（如 AccessKit）的进一步支持，AgentKit 将有潜力成为一个强大的通用 AI 自动化解决方案。
